<?xml version="1.0" encoding="utf-8" ?>
<Migration>
  <Up>
    <Statement>
      <![CDATA[
--■■■■■■■■■■■■■■
--1. CREATE TABLE
--■■■■■■■■■■■■■■

--■■■■■■■■■■■■■■
--2. ALTER COLUMN
--■■■■■■■■■■■■■■
 --********************************************************************
 ----------------------[w2_MallCooperationSetting]---------------------
 --********************************************************************
IF NOT EXISTS ( SELECT * FROM sys.columns WHERE name = 'lohaco_private_key' AND object_id = Object_ID('[dbo].[w2_MallCooperationSetting]'))
BEGIN
  ALTER TABLE [w2_MallCooperationSetting] ADD [lohaco_private_key] [nvarchar] (max) NOT NULL DEFAULT(N'');
END

IF NOT EXISTS ( SELECT * FROM sys.columns WHERE name = 'stock_update_use_flg' AND object_id = Object_ID('[dbo].[w2_MallCooperationSetting]'))
BEGIN
  ALTER TABLE [w2_MallCooperationSetting] ADD [stock_update_use_flg] [nvarchar] (10) NOT NULL DEFAULT(N'0');
END
GO

--■■■■■■■■■■■■■■
--3. INSERT RECORD
--■■■■■■■■■■■■■■
  --********************************************************************
 ------------------------------[w2_Payment]----------------------------
 --********************************************************************
IF NOT EXISTS (SELECT payment_id FROM [w2_Payment] WHERE payment_id = 'M70')
BEGIN
  INSERT INTO [w2_Payment]
  (
    shop_id
    ,payment_group_id
    ,payment_id
    ,payment_alt_id
    ,payment_name
    ,payment_name_mobile
    ,payment_price_kbn
    ,payment_price
    ,usable_price_min
    ,usable_price_max
    ,mobile_disp_flg
    ,display_order
    ,valid_flg
    ,del_flg
    ,date_created
    ,date_changed
    ,last_changed
    ,user_management_level_not_use
  )
  VALUES
  (
    '0'
    ,''
    ,'M70'
    ,''
    ,N'代金引換'
    ,N'代引'
    ,'1'
    ,0
    ,315
    ,300000
    ,'3'
    ,100
    ,'1'
    ,'0'
    ,CURRENT_TIMESTAMP
    ,CURRENT_TIMESTAMP
    ,'SYSTEM'
    ,''
  )
END

IF NOT EXISTS (SELECT payment_id FROM [w2_Payment] WHERE payment_id = 'M80')
BEGIN
  INSERT INTO [w2_Payment]
  (
    shop_id
    ,payment_group_id
    ,payment_id
    ,payment_alt_id
    ,payment_name
    ,payment_name_mobile
    ,payment_price_kbn
    ,payment_price
    ,usable_price_min
    ,usable_price_max
    ,mobile_disp_flg
    ,display_order
    ,valid_flg
    ,del_flg
    ,date_created
    ,date_changed
    ,last_changed
    ,user_management_level_not_use
  )
  VALUES
  (
    '0'
    ,''
    ,'M80'
    ,''
    ,N'クレジットカード'
    ,N'ｸﾚｼﾞｯﾄ'
    ,'0'
    ,0
    ,1
    ,NULL
    ,'3'
    ,11
    ,'1'
    ,'0'
    ,CURRENT_TIMESTAMP
    ,CURRENT_TIMESTAMP
    ,'SYSTEM'
    ,''
  )
END


IF NOT EXISTS (SELECT payment_id FROM [w2_PaymentPrice] WHERE payment_id = 'M70')
BEGIN
  INSERT INTO [w2_PaymentPrice]
  (
    shop_id
    ,payment_group_id
    ,payment_id
    ,payment_price_no
    ,tgt_price_bgn
    ,tgt_price_end
    ,payment_price
    ,del_flg
    ,date_created
    ,date_changed
    ,last_changed
  )
  VALUES
  (
    '0'
    ,''
    ,'M70'
    ,1
    ,0
    ,0
    ,0
    ,'0'
    ,CURRENT_TIMESTAMP
    ,CURRENT_TIMESTAMP
    ,'SYSTEM'
  )
END


IF NOT EXISTS (SELECT payment_id FROM [w2_PaymentPrice] WHERE payment_id = 'M80')
BEGIN
  INSERT INTO [w2_PaymentPrice]
  (
    shop_id
    ,payment_group_id
    ,payment_id
    ,payment_price_no
    ,tgt_price_bgn
    ,tgt_price_end
    ,payment_price
    ,del_flg
    ,date_created
    ,date_changed
    ,last_changed
  )
  VALUES
  (
    '0'
    ,''
    ,'M80'
    ,1
    ,0
    ,0
    ,0
    ,'0'
    ,CURRENT_TIMESTAMP
    ,CURRENT_TIMESTAMP
    ,'SYSTEM'
  )
END
GO
 --■■■■■■■■■■■■■■
--4. UPDATE RECORD
--■■■■■■■■■■■■■■


--■■■■■■■■■■■■■■
--5. CREATE VIEW
--■■■■■■■■■■■■■■

--■■■■■■■■■■■■■■
--6. TRIGGER
--■■■■■■■■■■■■■■
      ]]>
    </Statement>
  </Up>
</Migration>