<?xml version="1.0" encoding="utf-8" ?>
<Migration>
  <Up>
    <Statement>
      <![CDATA[
        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_MallCooperationSetting' AND COLUMN_NAME = 'yahoo_api_client_id')
          BEGIN
            ALTER TABLE w2_MallCooperationSetting ADD yahoo_api_client_id NVARCHAR(56) NOT NULL DEFAULT (N'');
          END
        GO

        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_MallCooperationSetting' AND COLUMN_NAME = 'yahoo_api_client_secret')
          BEGIN
            ALTER TABLE w2_MallCooperationSetting ADD yahoo_api_client_secret NVARCHAR(40) NOT NULL DEFAULT (N'');
          END
        GO

        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_MallCooperationSetting' AND COLUMN_NAME = 'yahoo_api_access_token')
          BEGIN
            ALTER TABLE w2_MallCooperationSetting ADD yahoo_api_access_token NVARCHAR(2200) NOT NULL DEFAULT (N'');
          END
        GO

        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_MallCooperationSetting' AND COLUMN_NAME = 'yahoo_api_access_token_expiration_datetime')
          BEGIN
            ALTER TABLE w2_MallCooperationSetting ADD yahoo_api_access_token_expiration_datetime DATETIME2;
          END
        GO

        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_MallCooperationSetting' AND COLUMN_NAME = 'yahoo_api_refresh_token')
          BEGIN
            ALTER TABLE w2_MallCooperationSetting ADD yahoo_api_refresh_token NVARCHAR(2200) NOT NULL DEFAULT (N'');
          END
        GO

        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_MallCooperationSetting' AND COLUMN_NAME = 'yahoo_api_refresh_token_expiration_datetime')
          BEGIN
            ALTER TABLE w2_MallCooperationSetting ADD yahoo_api_refresh_token_expiration_datetime DATETIME2;
          END
        GO

        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_MallCooperationSetting' AND COLUMN_NAME = 'yahoo_api_seller_id')
          BEGIN
            ALTER TABLE w2_MallCooperationSetting ADD yahoo_api_seller_id NVARCHAR(128) NOT NULL DEFAULT (N'');
          END
        GO
        
        IF NOT EXISTS (SELECT mail_id FROM [w2_MailTemplate] WHERE shop_id = '0' AND mail_id = N'10000121')
          BEGIN
            INSERT  [dbo].[w2_MailTemplate]
                    (
                      shop_id,
                      mail_id,
                      mail_name,
                      mail_from,
                      mail_to,
                      mail_cc,
                      mail_bcc,
                      mail_subject,
                      mail_body,
                      mail_subject_mobile,
                      mail_body_mobile,
                      mail_attachmentfile_path,
                      del_flg,
                      date_created,
                      date_changed,
                      last_changed,
                      mail_from_name,
                      mail_category,
                      auto_send_flg,
                      language_code,
                      language_locale_id,
                      sms_use_flg,
                      line_use_flg,
                      mailtext_html,
                      sendhtml_flg
                    )
            VALUES  (
                      '0',
                      '10000121',
                      'モール注文取込バッチ完了メール【管理者向け】',
                      'bh@w2s.xyz',
                      'bh@w2s.xyz',
                      '',
                      '',
                      'モール注文取込バッチ完了メール【管理者向け】',
                      'mall_id (@@ mall_id @@) のモール注文取込が完了しました。

件数: @@ total_count @@
成功: @@ successful_count @@
警告: @@ warning_count @@
失敗: @@ failed_count @@',
                      '',
                      '',
                      '',
                      '0',
                      GETDATE(),
                      GETDATE(),
                      'ｗ２ユーザー',
                      '',
                      '',
                      '1',
                      '',
                      '',
                      '0',
                      '0',
                      '',
                      '0'
                    )
          END
          GO

        IF NOT EXISTS (SELECT mail_id FROM [w2_MailTemplate] WHERE shop_id = '0' AND mail_id = N'10000122')
          BEGIN
            INSERT  [dbo].[w2_MailTemplate]
                    (
                      shop_id,
                      mail_id,
                      mail_name,
                      mail_from,
                      mail_to,
                      mail_cc,
                      mail_bcc,
                      mail_subject,
                      mail_body,
                      mail_subject_mobile,
                      mail_body_mobile,
                      mail_attachmentfile_path,
                      del_flg,
                      date_created,
                      date_changed,
                      last_changed,
                      mail_from_name,
                      mail_category,
                      auto_send_flg,
                      language_code,
                      language_locale_id,
                      sms_use_flg,
                      line_use_flg,
                      mailtext_html,
                      sendhtml_flg
                    )
            VALUES  (
                      '0',
                      '10000122',
                      'モール注文取込バッチ異常終了メール【管理者向け】',
                      'bh@w2s.xyz',
                      'bh@w2s.xyz',
                      '',
                      '',
                      'モール注文取込バッチ異常終了メール【管理者向け】',
                      'モール注文取込バッチにてエラーが発生しました。

エラーメッセージ:
@@ error_message @@
mall_id: @@ mall_id @@'
,
                      '',
                      '',
                      '',
                      '0',
                      GETDATE(),
                      GETDATE(),
                      'ｗ２ユーザー',
                      '',
                      '',
                      '1',
                      '',
                      '',
                      '0',
                      '0',
                      '',
                      '0'
                    )
          END
          GO
      ]]>
    </Statement>
  </Up>
</Migration>
