<?xml version="1.0" encoding="utf-8" ?>
<Migration>
  <Up>
    <Statement>
      <![CDATA[
		-- 既存項目定義変更
		ALTER TABLE [w2_ProductBundle] ALTER COLUMN [usable_times_kbn] [nvarchar] (20);
		ALTER TABLE [w2_ProductBundle] ALTER COLUMN [target_order_fixed_purchase_count_from] [int];
		ALTER TABLE [w2_ProductBundle] ALTER COLUMN [target_order_fixed_purchase_count_to] [int];
		-- カラム追加
		IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_ProductBundle' AND COLUMN_NAME = 'usable_times')
			ALTER TABLE [w2_ProductBundle] ADD [usable_times] [int];
		GO

        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_ProductBundle' AND COLUMN_NAME = 'target_product_category_ids')
			ALTER TABLE [w2_ProductBundle] ADD [target_product_category_ids] [nvarchar] (max) NOT NULL DEFAULT (N'');
		GO

        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_ProductBundle' AND COLUMN_NAME = 'except_product_ids')
			ALTER TABLE [w2_ProductBundle] ADD [except_product_ids] [nvarchar] (max) NOT NULL DEFAULT (N'');
		GO

        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_ProductBundle' AND COLUMN_NAME = 'except_product_category_ids')
			ALTER TABLE [w2_ProductBundle] ADD [except_product_category_ids] [nvarchar] (max) NOT NULL DEFAULT (N'');
		GO

        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_ProductBundle' AND COLUMN_NAME = 'target_id')
			ALTER TABLE [w2_ProductBundle] ADD [target_id] [nvarchar] (10) NOT NULL DEFAULT (N'');
		GO

        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_ProductBundle' AND COLUMN_NAME = 'target_id_except_flg')
			ALTER TABLE [w2_ProductBundle] ADD [target_id_except_flg] [nvarchar] (1) NOT NULL DEFAULT (N'0');
		GO

        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_ProductBundle' AND COLUMN_NAME = 'target_order_price_subtotal_min')
			ALTER TABLE [w2_ProductBundle] ADD [target_order_price_subtotal_min] [decimal] (18,3);
		GO

        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_ProductBundle' AND COLUMN_NAME = 'target_product_count_min')
			ALTER TABLE [w2_ProductBundle] ADD [target_product_count_min] [int];
		GO

        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_ProductBundle' AND COLUMN_NAME = 'target_advcodes_first')
			ALTER TABLE [w2_ProductBundle] ADD [target_advcodes_first] [nvarchar] (max) NOT NULL DEFAULT (N'');
		GO

        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_ProductBundle' AND COLUMN_NAME = 'target_advcodes_new')
			ALTER TABLE [w2_ProductBundle] ADD [target_advcodes_new] [nvarchar] (max) NOT NULL DEFAULT (N'');
		GO

        IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_ProductBundleItem' AND COLUMN_NAME = 'ordered_product_except_flg')
			ALTER TABLE [w2_ProductBundleItem] ADD [ordered_product_except_flg] [nvarchar] (1) NOT NULL DEFAULT (N'0');
		GO
      ]]>
    </Statement>
  </Up>
</Migration>