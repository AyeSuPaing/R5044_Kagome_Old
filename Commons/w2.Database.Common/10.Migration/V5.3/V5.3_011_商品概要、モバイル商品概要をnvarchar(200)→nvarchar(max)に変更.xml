<?xml version="1.0" encoding="utf-8" ?>
<Migration>
	<Up>
		<Statement>
			<![CDATA[
				-- 商品概要
				DECLARE @CONSTRAINT_NAME nvarchar (255)
				DECLARE @script VARCHAR(2000)
				SET @script = 'ALTER TABLE w2_Product DROP CONSTRAINT ' + 
					(
					SELECT sysobjects.name
						FROM sysobjects, syscolumns
					 WHERE syscolumns.id = object_id('w2_Product')
						 AND sysobjects.id = syscolumns.cdefault
						 AND syscolumns.name = 'outline'
					)
				EXEC(@script)
				ALTER TABLE [w2_Product] ALTER COLUMN [outline] [nvarchar] (max) NOT NULL
				ALTER TABLE [w2_Product] ADD DEFAULT (N'') for [outline];

				-- モバイル商品概要
				SET @script = 'ALTER TABLE w2_Product DROP CONSTRAINT ' + 
					(
					SELECT sysobjects.name
						FROM sysobjects, syscolumns
					 WHERE syscolumns.id = object_id('w2_Product')
						 AND sysobjects.id = syscolumns.cdefault
						 AND syscolumns.name = 'outline_mobile'
					)
				EXEC(@script)
				ALTER TABLE [w2_Product] ALTER COLUMN [outline_mobile] [nvarchar] (max) NOT NULL
				ALTER TABLE [w2_Product] ADD DEFAULT (N'') for [outline_mobile];

				-- 商品概要
				SET @script = 'ALTER TABLE w2_WorkProduct DROP CONSTRAINT ' + 
					(
					SELECT sysobjects.name
						FROM sysobjects, syscolumns
					 WHERE syscolumns.id = object_id('w2_WorkProduct')
						 AND sysobjects.id = syscolumns.cdefault
						 AND syscolumns.name = 'outline'
					)
				EXEC(@script)
				ALTER TABLE [w2_WorkProduct] ALTER COLUMN [outline] [nvarchar] (max) NOT NULL
				ALTER TABLE [w2_WorkProduct] ADD DEFAULT (N'') for [outline];

				-- モバイル商品概要
				SET @script = 'ALTER TABLE w2_WorkProduct DROP CONSTRAINT ' + 
					(
					SELECT sysobjects.name
						FROM sysobjects, syscolumns
					 WHERE syscolumns.id = object_id('w2_WorkProduct')
						 AND sysobjects.id = syscolumns.cdefault
						 AND syscolumns.name = 'outline_mobile'
					)
				EXEC(@script)
				ALTER TABLE [w2_WorkProduct] ALTER COLUMN [outline_mobile] [nvarchar] (max) NOT NULL
				ALTER TABLE [w2_WorkProduct] ADD DEFAULT (N'') for [outline_mobile];
			]]>
		</Statement>
	</Up>
</Migration>
