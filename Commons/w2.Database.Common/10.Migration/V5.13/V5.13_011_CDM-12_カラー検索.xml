<?xml version="1.0" encoding="utf-8" ?>
<Migration>
  <Up>
    <Statement>
      <![CDATA[
	  IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_Product' AND COLUMN_NAME = 'product_color_id')
	ALTER TABLE [w2_Product] ADD [product_color_id] [nvarchar] (50) NOT NULL DEFAULT (N'');
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_ProductVariation' AND COLUMN_NAME = 'variation_color_id')
	ALTER TABLE [w2_ProductVariation] ADD [variation_color_id] [nvarchar] (50) NOT NULL DEFAULT (N'');
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_WorkProduct' AND COLUMN_NAME = 'product_color_id')
	ALTER TABLE [dbo].[w2_WorkProduct] ADD [product_color_id] [nvarchar] (50) NOT NULL DEFAULT (N'');
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'w2_WorkProductVariation' AND COLUMN_NAME = 'variation_color_id')
	ALTER TABLE [dbo].[w2_WorkProductVariation] ADD [variation_color_id] [nvarchar] (50) NOT NULL DEFAULT (N'');

/****** Object:  View [dbo].[w2_ProductVariationView]    Script Date: 2018/05/11 19:48:42 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

/*
=========================================================================================================
  Module      : 商品バリエーションビュー(w2_ProductVariationView.sql)
 ･･･････････････････････････････････････････････････････････････････････････････････････････････････････
  Copyright   : Copyright W2 Co.,Ltd. 2011 All Rights Reserved.
=========================================================================================================
*/
ALTER VIEW [dbo].[w2_ProductVariationView]
            (
              [shop_id],
              [product_id],
              [variation_id],
              [variation_cooperation_id1],
              [variation_cooperation_id2],
              [variation_cooperation_id3],
              [variation_cooperation_id4],
              [variation_cooperation_id5],
              [variation_cooperation_id6],
              [variation_cooperation_id7],
              [variation_cooperation_id8],
              [variation_cooperation_id9],
              [variation_cooperation_id10],
              [mall_variation_id1],
              [mall_variation_id2],
              [mall_variation_type],
              [variation_name1],
              [variation_name2],
              [variation_name3],
              [price],
              [special_price],
              [variation_image_head],
              [variation_image_mobile],
              [shipping_type],
              [shipping_size_kbn],
              [display_order],
              [variation_mall_cooperated_flg],
              [valid_flg],
              [del_flg],
              [date_created],
              [date_changed],
              [last_changed],
              [variation_download_url],
              [variation_fixed_purchase_firsttime_price],
              [variation_fixed_purchase_price],
              [use_variation_flg],
              [check_fixed_purchase_firsttime_flg],
              [variation_andmall_reservation_flg],
			  [variation_color_id]
            ) AS
     -- バリエーション使用フラグがOFFの場合は商品データから持ってくる（shop_idとproduct_idはインデックスが効かなくなるためCASEで分岐させない）
     SELECT [dbo].[w2_Product].[shop_id],
            [dbo].[w2_Product].[product_id],
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[product_id]            ELSE [dbo].[w2_ProductVariation].[variation_id]                  END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[cooperation_id1]       ELSE [dbo].[w2_ProductVariation].[variation_cooperation_id1]     END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[cooperation_id2]       ELSE [dbo].[w2_ProductVariation].[variation_cooperation_id2]     END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[cooperation_id3]       ELSE [dbo].[w2_ProductVariation].[variation_cooperation_id3]     END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[cooperation_id4]       ELSE [dbo].[w2_ProductVariation].[variation_cooperation_id4]     END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[cooperation_id5]       ELSE [dbo].[w2_ProductVariation].[variation_cooperation_id5]     END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[cooperation_id6]       ELSE [dbo].[w2_ProductVariation].[variation_cooperation_id6]     END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[cooperation_id7]       ELSE [dbo].[w2_ProductVariation].[variation_cooperation_id7]     END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[cooperation_id8]       ELSE [dbo].[w2_ProductVariation].[variation_cooperation_id8]     END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[cooperation_id9]       ELSE [dbo].[w2_ProductVariation].[variation_cooperation_id9]     END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[cooperation_id10]      ELSE [dbo].[w2_ProductVariation].[variation_cooperation_id10]    END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN ''                                         ELSE [dbo].[w2_ProductVariation].[mall_variation_id1]            END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN ''                                         ELSE [dbo].[w2_ProductVariation].[mall_variation_id2]            END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN ''                                         ELSE [dbo].[w2_ProductVariation].[mall_variation_type]           END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN ''                                         ELSE [dbo].[w2_ProductVariation].[variation_name1]               END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN ''                                         ELSE [dbo].[w2_ProductVariation].[variation_name2]               END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN ''                                         ELSE [dbo].[w2_ProductVariation].[variation_name3]               END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[display_price]         ELSE [dbo].[w2_ProductVariation].[price]                         END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[display_special_price] ELSE [dbo].[w2_ProductVariation].[special_price]                 END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[image_head]            ELSE [dbo].[w2_ProductVariation].[variation_image_head]          END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[image_mobile]          ELSE [dbo].[w2_ProductVariation].[variation_image_mobile]        END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[shipping_type]         ELSE [dbo].[w2_ProductVariation].[shipping_type]                 END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[shipping_size_kbn]     ELSE [dbo].[w2_ProductVariation].[shipping_size_kbn]             END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN 1                                          ELSE [dbo].[w2_ProductVariation].[display_order]                 END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[mall_cooperated_flg]   ELSE [dbo].[w2_ProductVariation].[variation_mall_cooperated_flg] END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[valid_flg]             ELSE [dbo].[w2_ProductVariation].[valid_flg]                     END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[del_flg]               ELSE [dbo].[w2_ProductVariation].[del_flg]                       END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[date_created]          ELSE [dbo].[w2_ProductVariation].[date_created]                  END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[date_changed]          ELSE [dbo].[w2_ProductVariation].[date_changed]                  END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[last_changed]          ELSE [dbo].[w2_ProductVariation].[last_changed]                  END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[download_url]          ELSE [dbo].[w2_ProductVariation].[variation_download_url]                  END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[fixed_purchase_firsttime_price] ELSE [dbo].[w2_ProductVariation].[variation_fixed_purchase_firsttime_price] END,
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[fixed_purchase_price]  ELSE [dbo].[w2_ProductVariation].[variation_fixed_purchase_price] END,
            [dbo].[w2_Product].[use_variation_flg],
            [dbo].[w2_Product].[check_fixed_purchase_firsttime_flg],
            CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN [dbo].[w2_Product].[andmall_reservation_flg] ELSE [dbo].[w2_ProductVariation].[variation_andmall_reservation_flg] END,
			CASE WHEN [dbo].[w2_Product].[use_variation_flg] != '1' THEN ''                                         ELSE [dbo].[w2_ProductVariation].[variation_color_id] END
       FROM [dbo].[w2_Product]
  LEFT JOIN [dbo].[w2_ProductVariation] ON
            (
              [dbo].[w2_ProductVariation].[shop_id] = [dbo].[w2_Product].[shop_id]
              AND
              [dbo].[w2_ProductVariation].[product_id] = [dbo].[w2_Product].[product_id]
            )

GO

/****** Object:  View [dbo].[w2_ProductView]    Script Date: 2018/05/11 19:44:10 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

/*
=========================================================================================================
  Module      : 商品情報ビュー(w2_ProductView.sql)
 ･･･････････････････････････････････････････････････････････････････････････････････････････････････････
  Copyright   : Copyright W2 Co.,Ltd. 2009 All Rights Reserved.
=========================================================================================================
*/
ALTER VIEW [dbo].[w2_ProductView](
		[shop_id],
		[supplier_id],
		[product_id],
		[cooperation_id1],
		[cooperation_id2],
		[cooperation_id3],
		[cooperation_id4],
		[cooperation_id5],
		[mall_ex_product_id],
		[maker_id],
		[maker_name],
		[name],
		[name_kana],
		[name2],
		[name2_kana],
		[seo_keywords],
		[catchcopy],
		[catchcopy_mobile],
		[outline_kbn],
		[outline],
		[outline_kbn_mobile],
		[outline_mobile],
		[desc_detail_kbn1],
		[desc_detail1],
		[desc_detail_kbn2],
		[desc_detail2],
		[desc_detail_kbn3],
		[desc_detail3],
		[desc_detail_kbn4],
		[desc_detail4],
		[return_exchange_message],
		[desc_detail_kbn1_mobile],
		[desc_detail1_mobile],
		[desc_detail_kbn2_mobile],
		[desc_detail2_mobile],
		[return_exchange_message_mobile],
		[note],
		[display_price],
		[display_special_price],
		[tax_included_flg],
		[tax_rate],
		[tax_round_type],
		[price_pretax],
		[price_shipping],
		[shipping_type],
		[shipping_size_kbn],
		[price_cost],
		[point_kbn1],
		[point1],
		[point_kbn2],
		[point2],
		[point_kbn3],
		[point3],
		[campaign_from],
		[campaign_to],
		[campaign_point_kbn],
		[campaign_point],
		[display_from],
		[display_to],
		[sell_from],
		[sell_to],
		[before_sale_display_kbn],
		[after_sale_display_kbn],
		[max_sell_quantity],
		[stock_management_kbn],
		[stock_message_id],
		[stock_disp_kbn],
		[url],
		[inquire_email],
		[inquire_tel],
		[display_kbn],
		[category_id1],
		[category_id2],
		[category_id3],
		[category_id4],
		[category_id5],
		[related_product_id_cs1],
		[related_product_id_cs2],
		[related_product_id_cs3],
		[related_product_id_cs4],
		[related_product_id_cs5],
		[related_product_id_us1],
		[related_product_id_us2],
		[related_product_id_us3],
		[related_product_id_us4],
		[related_product_id_us5],
		[image_head],
		[image_mobile],
		[icon_flg1],
		[icon_term_end1],
		[icon_flg2],
		[icon_term_end2],
		[icon_flg3],
		[icon_term_end3],
		[icon_flg4],
		[icon_term_end4],
		[icon_flg5],
		[icon_term_end5],
		[icon_flg6],
		[icon_term_end6],
		[icon_flg7],
		[icon_term_end7],
		[icon_flg8],
		[icon_term_end8],
		[icon_flg9],
		[icon_term_end9],
		[icon_flg10],
		[icon_term_end10],
		[mobile_disp_flg],
		[use_variation_flg],
		[reservation_flg],
		[fixed_purchase_flg],
		[valid_flg],
		[variation_id],
		[variation_cooperation_id1],
		[variation_cooperation_id2],
		[variation_cooperation_id3],
		[variation_cooperation_id4],
		[variation_cooperation_id5],
		[mall_variation_id1],
		[mall_variation_id2],
		[mall_variation_type],
		[variation_name1],
		[variation_name2],
		[variation_name3],
		[price],
		[special_price],
		[variation_image_head],
		[variation_image_mobile],
		[display_order],
		[productsale_id],
		[sale_price],
		[validity],
		[stock],
		[realstock],
		[realstock_b],
		[realstock_c],
		[realstock_reserved],
		[stock_alert],
		[stock_message_name],
		[stock_message_def],
		[stock_datum1],
		[stock_message1],
		[stock_datum2],
		[stock_message2],
		[stock_datum3],
		[stock_message3],
		[stock_datum4],
		[stock_message4],
		[stock_datum5],
		[stock_message5],
		[stock_datum6],
		[stock_message6],
		[stock_datum7],
		[stock_message7],
		[stock_message_def_mobile],
		[stock_message_mobile1],
		[stock_message_mobile2],
		[stock_message_mobile3],
		[stock_message_mobile4],
		[stock_message_mobile5],
		[stock_message_mobile6],
		[stock_message_mobile7],
		[del_flg],
		[date_created],
		[date_changed],
		[last_changed],
		[shipping_id],
		[shipping_fixed_purchase_flg],
		[wrapping_paper_flg],
		[wrapping_paper_types],
		[wrapping_bag_flg],
		[wrapping_bag_types],
		[search_keyword],
		[member_rank_discount_flg],
		[display_member_rank],
		[buyable_member_rank],
		[google_shopping_flg],
		[product_option_settings],
		[arrival_mail_valid_flg],
		[release_mail_valid_flg],
		[resale_mail_valid_flg],
		[select_variation_kbn],
		[select_variation_kbn_mobile],
		[brand_id1],
		[brand_id2],
		[brand_id3],
		[brand_id4],
		[brand_id5],
		[plural_shipping_price_free_flg],
		[age_limit_flg],
		[gift_flg],
		[digital_contents_flg],
		[download_url],
		[variation_download_url],
		[display_sell_flg],
		[display_priority],
		[limited_payment_ids],
		[fixed_purchase_firsttime_price],
		[fixed_purchase_price],
		[variation_fixed_purchase_firsttime_price],
		[variation_fixed_purchase_price],
		[bundle_item_display_type],
		[product_type],
		[limited_fixed_purchase_kbn1_setting],
		[limited_fixed_purchase_kbn3_setting],
		[recommend_product_id],
		[check_fixed_purchase_firsttime_flg],
		[cooperation_id6],
		[cooperation_id7],
		[cooperation_id8],
		[cooperation_id9],
		[cooperation_id10],
		[variation_cooperation_id6],
		[variation_cooperation_id7],
		[variation_cooperation_id8],
		[variation_cooperation_id9],
		[variation_cooperation_id10],
		[andmall_reservation_flg],
		[variation_andmall_reservation_flg],
		[product_color_id],
		[variation_color_id]
		) AS
SELECT	[dbo].[w2_Product].[shop_id],
		[dbo].[w2_Product].[supplier_id],
		[dbo].[w2_Product].[product_id],
		[dbo].[w2_Product].[cooperation_id1],
		[dbo].[w2_Product].[cooperation_id2],
		[dbo].[w2_Product].[cooperation_id3],
		[dbo].[w2_Product].[cooperation_id4],
		[dbo].[w2_Product].[cooperation_id5],
		[dbo].[w2_Product].[mall_ex_product_id],
		[dbo].[w2_Product].[maker_id],
		[dbo].[w2_Product].[maker_name],
		[dbo].[w2_Product].[name],
		[dbo].[w2_Product].[name_kana],
		[dbo].[w2_Product].[name2],
		[dbo].[w2_Product].[name2_kana],
		[dbo].[w2_Product].[seo_keywords],
		[dbo].[w2_Product].[catchcopy],
		[dbo].[w2_Product].[catchcopy_mobile],
		[dbo].[w2_Product].[outline_kbn],
		[dbo].[w2_Product].[outline],
		[dbo].[w2_Product].[outline_kbn_mobile],
		[dbo].[w2_Product].[outline_mobile],
		[dbo].[w2_Product].[desc_detail_kbn1],
		[dbo].[w2_Product].[desc_detail1],
		[dbo].[w2_Product].[desc_detail_kbn2],
		[dbo].[w2_Product].[desc_detail2],
		[dbo].[w2_Product].[desc_detail_kbn3],
		[dbo].[w2_Product].[desc_detail3],
		[dbo].[w2_Product].[desc_detail_kbn4],
		[dbo].[w2_Product].[desc_detail4],
		[dbo].[w2_Product].[return_exchange_message],		
		[dbo].[w2_Product].[desc_detail_kbn1_mobile],
		[dbo].[w2_Product].[desc_detail1_mobile],
		[dbo].[w2_Product].[desc_detail_kbn2_mobile],
		[dbo].[w2_Product].[desc_detail2_mobile],
		[dbo].[w2_Product].[return_exchange_message_mobile],
		[dbo].[w2_Product].[note],
		[dbo].[w2_Product].[display_price],
		[dbo].[w2_Product].[display_special_price],
		[dbo].[w2_Product].[tax_included_flg],
		[dbo].[w2_Product].[tax_rate],
		[dbo].[w2_Product].[tax_round_type],
		[dbo].[w2_Product].[price_pretax],
		[dbo].[w2_Product].[price_shipping],
		[dbo].[w2_Product].[shipping_type],
		[dbo].[w2_Product].[shipping_size_kbn],
		[dbo].[w2_Product].[price_cost],
		[dbo].[w2_Product].[point_kbn1],
		[dbo].[w2_Product].[point1],
		[dbo].[w2_Product].[point_kbn2],
		[dbo].[w2_Product].[point2],
		[dbo].[w2_Product].[point_kbn3],
		[dbo].[w2_Product].[point3],
		[dbo].[w2_Product].[campaign_from],
		[dbo].[w2_Product].[campaign_to],
		[dbo].[w2_Product].[campaign_point_kbn],
		[dbo].[w2_Product].[campaign_point],
		[dbo].[w2_Product].[display_from],
		[dbo].[w2_Product].[display_to],
		[dbo].[w2_Product].[sell_from],
		[dbo].[w2_Product].[sell_to],
		[dbo].[w2_Product].[before_sale_display_kbn],
		[dbo].[w2_Product].[after_sale_display_kbn],
		[dbo].[w2_Product].[max_sell_quantity],
		[dbo].[w2_Product].[stock_management_kbn],
		[dbo].[w2_Product].[stock_message_id],
		[dbo].[w2_Product].[stock_disp_kbn],
		[dbo].[w2_Product].[url],
		[dbo].[w2_Product].[inquire_email],
		[dbo].[w2_Product].[inquire_tel],
		[dbo].[w2_Product].[display_kbn],
		[dbo].[w2_Product].[category_id1],
		[dbo].[w2_Product].[category_id2],
		[dbo].[w2_Product].[category_id3],
		[dbo].[w2_Product].[category_id4],
		[dbo].[w2_Product].[category_id5],
		[dbo].[w2_Product].[related_product_id_cs1],
		[dbo].[w2_Product].[related_product_id_cs2],
		[dbo].[w2_Product].[related_product_id_cs3],
		[dbo].[w2_Product].[related_product_id_cs4],
		[dbo].[w2_Product].[related_product_id_cs5],
		[dbo].[w2_Product].[related_product_id_us1],
		[dbo].[w2_Product].[related_product_id_us2],
		[dbo].[w2_Product].[related_product_id_us3],
		[dbo].[w2_Product].[related_product_id_us4],
		[dbo].[w2_Product].[related_product_id_us5],
		[dbo].[w2_Product].[image_head],
		[dbo].[w2_Product].[image_mobile],
		[dbo].[w2_Product].[icon_flg1],
		[dbo].[w2_Product].[icon_term_end1],
		[dbo].[w2_Product].[icon_flg2],
		[dbo].[w2_Product].[icon_term_end2],
		[dbo].[w2_Product].[icon_flg3],
		[dbo].[w2_Product].[icon_term_end3],
		[dbo].[w2_Product].[icon_flg4],
		[dbo].[w2_Product].[icon_term_end4],
		[dbo].[w2_Product].[icon_flg5],
		[dbo].[w2_Product].[icon_term_end5],
		[dbo].[w2_Product].[icon_flg6],
		[dbo].[w2_Product].[icon_term_end6],
		[dbo].[w2_Product].[icon_flg7],
		[dbo].[w2_Product].[icon_term_end7],
		[dbo].[w2_Product].[icon_flg8],
		[dbo].[w2_Product].[icon_term_end8],
		[dbo].[w2_Product].[icon_flg9],
		[dbo].[w2_Product].[icon_term_end9],
		[dbo].[w2_Product].[icon_flg10],
		[dbo].[w2_Product].[icon_term_end10],
		[dbo].[w2_Product].[mobile_disp_flg],
		[dbo].[w2_Product].[use_variation_flg],
		[dbo].[w2_Product].[reservation_flg],
		[dbo].[w2_Product].[fixed_purchase_flg],
		[dbo].[w2_Product].[valid_flg],
		[dbo].[w2_ProductVariationView].[variation_id],
		[dbo].[w2_ProductVariationView].[variation_cooperation_id1],
		[dbo].[w2_ProductVariationView].[variation_cooperation_id2],
		[dbo].[w2_ProductVariationView].[variation_cooperation_id3],
		[dbo].[w2_ProductVariationView].[variation_cooperation_id4],
		[dbo].[w2_ProductVariationView].[variation_cooperation_id5],
		[dbo].[w2_ProductVariationView].[mall_variation_id1],
		[dbo].[w2_ProductVariationView].[mall_variation_id2],
		[dbo].[w2_ProductVariationView].[mall_variation_type],
		[dbo].[w2_ProductVariationView].[variation_name1],
		[dbo].[w2_ProductVariationView].[variation_name2],
		[dbo].[w2_ProductVariationView].[variation_name3],
		[dbo].[w2_ProductVariationView].[price],
		[dbo].[w2_ProductVariationView].[special_price],
		[dbo].[w2_ProductVariationView].[variation_image_head],
		[dbo].[w2_ProductVariationView].[variation_image_mobile],
		[dbo].[w2_ProductVariationView].[display_order],
		[dbo].[w2_ProductSaleView].[productsale_id],
		[dbo].[w2_ProductSaleView].[sale_price],
		[dbo].[w2_ProductSaleView].[validity],
		[dbo].[w2_ProductStock].[stock],
		[dbo].[w2_ProductStock].[realstock],
		[dbo].[w2_ProductStock].[realstock_b],
		[dbo].[w2_ProductStock].[realstock_c],
		[dbo].[w2_ProductStock].[realstock_reserved],
		[dbo].[w2_ProductStock].[stock_alert],
		[dbo].[w2_ProductStockMessage].[stock_message_name],
		[dbo].[w2_ProductStockMessage].[stock_message_def],
		[dbo].[w2_ProductStockMessage].[stock_datum1],
		[dbo].[w2_ProductStockMessage].[stock_message1],
		[dbo].[w2_ProductStockMessage].[stock_datum2],
		[dbo].[w2_ProductStockMessage].[stock_message2],
		[dbo].[w2_ProductStockMessage].[stock_datum3],
		[dbo].[w2_ProductStockMessage].[stock_message3],
		[dbo].[w2_ProductStockMessage].[stock_datum4],
		[dbo].[w2_ProductStockMessage].[stock_message4],
		[dbo].[w2_ProductStockMessage].[stock_datum5],
		[dbo].[w2_ProductStockMessage].[stock_message5],
		[dbo].[w2_ProductStockMessage].[stock_datum6],
		[dbo].[w2_ProductStockMessage].[stock_message6],
		[dbo].[w2_ProductStockMessage].[stock_datum7],
		[dbo].[w2_ProductStockMessage].[stock_message7],
		[dbo].[w2_ProductStockMessage].[stock_message_def_mobile],
		[dbo].[w2_ProductStockMessage].[stock_message_mobile1],
		[dbo].[w2_ProductStockMessage].[stock_message_mobile2],
		[dbo].[w2_ProductStockMessage].[stock_message_mobile3],
		[dbo].[w2_ProductStockMessage].[stock_message_mobile4],
		[dbo].[w2_ProductStockMessage].[stock_message_mobile5],
		[dbo].[w2_ProductStockMessage].[stock_message_mobile6],
		[dbo].[w2_ProductStockMessage].[stock_message_mobile7],
		[dbo].[w2_Product].[del_flg],
		[dbo].[w2_Product].[date_created],
		[dbo].[w2_Product].[date_changed],
		[dbo].[w2_Product].[last_changed],
		[dbo].[w2_ShopShipping].[shipping_id],
		[dbo].[w2_ShopShipping].[fixed_purchase_flg],
		[dbo].[w2_ShopShipping].[wrapping_paper_flg],
		[dbo].[w2_ShopShipping].[wrapping_paper_types],
		[dbo].[w2_ShopShipping].[wrapping_bag_flg],
		[dbo].[w2_ShopShipping].[wrapping_bag_types],
		[dbo].[w2_Product].[search_keyword],
		[dbo].[w2_Product].[member_rank_discount_flg],
		[dbo].[w2_Product].[display_member_rank],
		[dbo].[w2_Product].[buyable_member_rank],
		[dbo].[w2_Product].[google_shopping_flg],
		[dbo].[w2_Product].[product_option_settings],
		[dbo].[w2_Product].[arrival_mail_valid_flg],
		[dbo].[w2_Product].[release_mail_valid_flg],
		[dbo].[w2_Product].[resale_mail_valid_flg],
		[dbo].[w2_Product].[select_variation_kbn],
		[dbo].[w2_Product].[select_variation_kbn_mobile],
		[dbo].[w2_Product].[brand_id1],
		[dbo].[w2_Product].[brand_id2],
		[dbo].[w2_Product].[brand_id3],
		[dbo].[w2_Product].[brand_id4],
		[dbo].[w2_Product].[brand_id5],
    [dbo].[w2_Product].[plural_shipping_price_free_flg],
		[dbo].[w2_Product].[age_limit_flg],
		[dbo].[w2_Product].[gift_flg],
		[dbo].[w2_Product].[digital_contents_flg],
		[dbo].[w2_Product].[download_url],
		[dbo].[w2_ProductVariationView].[variation_download_url],
		[dbo].[w2_Product].[display_sell_flg],
		[dbo].[w2_Product].[display_priority],
		[dbo].[w2_Product].[limited_payment_ids],
		[dbo].[w2_Product].[fixed_purchase_firsttime_price],
		[dbo].[w2_Product].[fixed_purchase_price],
		[dbo].[w2_ProductVariationView].[variation_fixed_purchase_firsttime_price],
		[dbo].[w2_ProductVariationView].[variation_fixed_purchase_price],
		[dbo].[w2_Product].[bundle_item_display_type],
		[dbo].[w2_Product].[product_type],
		[dbo].[w2_Product].[limited_fixed_purchase_kbn1_setting],
		[dbo].[w2_Product].[limited_fixed_purchase_kbn3_setting],
		[dbo].[w2_Product].[recommend_product_id],
		[dbo].[w2_Product].[check_fixed_purchase_firsttime_flg],
		[dbo].[w2_Product].[cooperation_id6],
		[dbo].[w2_Product].[cooperation_id7],
		[dbo].[w2_Product].[cooperation_id8],
		[dbo].[w2_Product].[cooperation_id9],
		[dbo].[w2_Product].[cooperation_id10],
		[dbo].[w2_ProductVariationView].[variation_cooperation_id6],
		[dbo].[w2_ProductVariationView].[variation_cooperation_id7],
		[dbo].[w2_ProductVariationView].[variation_cooperation_id8],
		[dbo].[w2_ProductVariationView].[variation_cooperation_id9],
		[dbo].[w2_ProductVariationView].[variation_cooperation_id10],
		[dbo].[w2_Product].[andmall_reservation_flg],
		[dbo].[w2_ProductVariationView].[variation_andmall_reservation_flg],
		[dbo].[w2_Product].[product_color_id],
		[dbo].[w2_ProductVariationView].[variation_color_id]
FROM	[dbo].[w2_Product] LEFT JOIN [dbo].[w2_ProductStockMessage] ON
		(
			[dbo].[w2_Product].[shop_id] = [dbo].[w2_ProductStockMessage].[shop_id]
			AND
			[dbo].[w2_Product].[stock_message_id] = [dbo].[w2_ProductStockMessage].[stock_message_id]
		)
		INNER JOIN [dbo].[w2_ProductVariationView] ON
		(
			[dbo].[w2_Product].[shop_id] = [dbo].[w2_ProductVariationView].[shop_id]
			AND
			[dbo].[w2_Product].[product_id] = [dbo].[w2_ProductVariationView].[product_id]
			AND
			(
				(
					[dbo].[w2_Product].[use_variation_flg] = '1'
					AND
					[dbo].[w2_Product].[product_id] != [dbo].[w2_ProductVariationView].[variation_id]
				)
				OR
				(
					[dbo].[w2_Product].[use_variation_flg] != '1'
					AND
					[dbo].[w2_Product].[product_id] = [dbo].[w2_ProductVariationView].[variation_id]
				)
			)
		)
		LEFT JOIN [dbo].[w2_ProductSaleView] ON
		(
			[dbo].[w2_ProductVariationView].[shop_id] = [dbo].[w2_ProductSaleView].[shop_id]
			AND
			[dbo].[w2_ProductSaleView].[productsale_kbn] = 'TS'
			AND
			[dbo].[w2_ProductVariationView].[product_id] = [dbo].[w2_ProductSaleView].[product_id]
			AND
			[dbo].[w2_ProductVariationView].[variation_id] = [dbo].[w2_ProductSaleView].[variation_id]
			AND
			[dbo].[w2_ProductSaleView].[validity] = '1'
		)
		LEFT JOIN [dbo].[w2_ProductStock] ON
		(
			[dbo].[w2_ProductVariationView].[shop_id] = [dbo].[w2_ProductStock].[shop_id]
			AND
			[dbo].[w2_ProductVariationView].[product_id] = [dbo].[w2_ProductStock].[product_id]
			AND
			[dbo].[w2_ProductVariationView].[variation_id] = [dbo].[w2_ProductStock].[variation_id]
		)
		LEFT JOIN [dbo].[w2_ShopShipping] ON
		(
			[dbo].[w2_Product].[shop_id] = [dbo].[w2_ShopShipping].[shop_id]
			AND
			[dbo].[w2_Product].[shipping_type] = [dbo].[w2_ShopShipping].[shipping_id]
		)

GO

      ]]>
    </Statement>
  </Up>
</Migration>