<?xml version="1.0" encoding="utf-8" ?>
<!--
=========================================================================================================
  Module      : 定期出荷予測系SQLサブステートメントXML (FixedPurchaseForecast_Sub.xml)
 ･･･････････････････････････････････････････････････････････････････････････････････････････････････････
  Copyright   : Copyright W2 Co.,Ltd. 2021 All Rights Reserved.
=========================================================================================================
-->
<FixedPurchaseForecast_Sub>

  <!-- 商品検索用WHERE文 -->
  <FIXEDPURCHASEFORECAST_PRODUCT_SEARCH_WHERE>
    <Statement>
      <![CDATA[
        WHERE  (
                 w2_Product.shop_id = @shop_id
                 <@@hasval:product_id_like_escaped@@>
                   AND  (
                          @product_id_like_escaped = ''
                          OR
                          w2_Product.product_id LIKE @product_id_like_escaped + '%' ESCAPE '#'
                        )
                 </@@hasval:product_id_like_escaped@@>
                 <@@hasval:product_name_like_escaped@@>
                   AND  (
                          @product_name_like_escaped = ''
                          OR
                          w2_Product.name LIKE @product_name_like_escaped + '%' ESCAPE '#'
                        )
                 </@@hasval:product_name_like_escaped@@>
                 <@@hasval:category_id_like_escaped@@>
                   AND  (
                          @category_id_like_escaped = ''
                          OR
                          w2_Product.category_id1 LIKE @category_id_like_escaped + '%' ESCAPE '#'
                          OR
                          w2_Product.category_id2 LIKE @category_id_like_escaped + '%' ESCAPE '#'
                          OR
                          w2_Product.category_id3 LIKE @category_id_like_escaped + '%' ESCAPE '#'
                          OR
                          w2_Product.category_id4 LIKE @category_id_like_escaped + '%' ESCAPE '#'
                          OR
                          w2_Product.category_id5 LIKE @category_id_like_escaped + '%' ESCAPE '#'
                        )
                 </@@hasval:category_id_like_escaped@@>
                 <@@hasval:shipping_type@@>
                   AND  (
                          @shipping_type = ''
                          OR
                          w2_Product.shipping_type = @shipping_type
                        )
                 </@@hasval:shipping_type@@>
               )
      ]]>
    </Statement>
    <Parameter>
      <Input Name="shop_id" Type="nvarchar" Size="10"/>
      <Input Name="product_id_like_escaped" Type="nvarchar" Size="60"/>
      <Input Name="product_name_like_escaped" Type="nvarchar" Size="200"/>
      <Input Name="category_id_like_escaped" Type="nvarchar" Size="60"/>
      <Input Name="shipping_type" Type="nvarchar" Size="20"/>
    </Parameter>
  </FIXEDPURCHASEFORECAST_PRODUCT_SEARCH_WHERE>

  <!-- 商品バリエーション検索用WHERE文 -->
  <FIXEDPURCHASEFORECAST_PRODUCT_VARIATION_SEARCH_WHERE>
    <Statement>
      <![CDATA[
        WHERE  (
                 w2_ProductVariationView.shop_id = @shop_id
                 <@@hasval:product_id_like_escaped@@>
                   AND  (
                          @product_id_like_escaped = ''
                          OR
                          w2_ProductVariationView.product_id LIKE @product_id_like_escaped + '%' ESCAPE '#'
                        )
                 </@@hasval:product_id_like_escaped@@>
                 <@@hasval:product_name_like_escaped@@>
                   AND  (
                          @product_name_like_escaped = ''
                          OR
                          w2_Product.name LIKE @product_name_like_escaped + '%' ESCAPE '#'
                        )
                 </@@hasval:product_name_like_escaped@@>
                 <@@hasval:category_id_like_escaped@@>
                   AND  (
                          @category_id_like_escaped = ''
                          OR
                          w2_Product.category_id1 LIKE @category_id_like_escaped + '%' ESCAPE '#'
                          OR
                          w2_Product.category_id2 LIKE @category_id_like_escaped + '%' ESCAPE '#'
                          OR
                          w2_Product.category_id3 LIKE @category_id_like_escaped + '%' ESCAPE '#'
                          OR
                          w2_Product.category_id4 LIKE @category_id_like_escaped + '%' ESCAPE '#'
                          OR
                          w2_Product.category_id5 LIKE @category_id_like_escaped + '%' ESCAPE '#'
                        )
                 </@@hasval:category_id_like_escaped@@>
                 <@@hasval:shipping_type@@>
                   AND  (
                          @shipping_type = ''
                          OR
                          w2_ProductVariationView.shipping_type = @shipping_type
                        )
                 </@@hasval:shipping_type@@>
               )
      ]]>
    </Statement>
    <Parameter>
      <Input Name="shop_id" Type="nvarchar" Size="10"/>
      <Input Name="product_id_like_escaped" Type="nvarchar" Size="60"/>
      <Input Name="product_name_like_escaped" Type="nvarchar" Size="200"/>
      <Input Name="category_id_like_escaped" Type="nvarchar" Size="60"/>
      <Input Name="shipping_type" Type="nvarchar" Size="20"/>
    </Parameter>
  </FIXEDPURCHASEFORECAST_PRODUCT_VARIATION_SEARCH_WHERE>

</FixedPurchaseForecast_Sub>
