<?xml version="1.0" encoding="utf-8" ?>
<!--
=========================================================================================================
  Module      : 会員ランク変動ルール系SQLサブステートメントXML(MemberRankRule_Sub.xml)
 ･･･････････････････････････････････････････････････････････････････････････････････････････････････････
  Copyright   : Copyright W2 Co.,Ltd. 2010 All Rights Reserved.
=========================================================================================================
-->
<MemberRankRule_Sub>

  <!-- 会員ランク変動ルール一覧取得用WHERE文 -->
  <MEMBERRANKRULE_SEARCH_WHERE>
    <Statement>
      <![CDATA[
         WHERE  (
                  (@member_rank_rule_id_like_escaped = '' OR w2_MemberRankRule.member_rank_rule_id LIKE @member_rank_rule_id_like_escaped + '%'  ESCAPE '#')      -- ランク付与ルールID
                  AND 
                  (@member_rank_rule_name_like_escaped = '' OR w2_MemberRankRule.member_rank_rule_name LIKE '%' + @member_rank_rule_name_like_escaped + '%'  ESCAPE '#')      -- ランク付与ルール名
                )
      ]]>
    </Statement>
  </MEMBERRANKRULE_SEARCH_WHERE>

  <!-- 会員ランク変動ルール一覧取得用ORDER_BY -->
  <MEMBERRANKRULE_SEARCH_ORDER_BY>
    <Statement>
      <![CDATA[
        ORDER BY
          w2_MemberRankRule.date_created DESC,
          -- 常に一定の結果セットを得るため、主キー（昇順）ソート
          w2_MemberRankRule.member_rank_rule_id ASC
      ]]>
    </Statement>
  </MEMBERRANKRULE_SEARCH_ORDER_BY>

</MemberRankRule_Sub>