<?xml version="1.0" encoding="utf-8" ?>
<!--
=========================================================================================================
  Module      : 商品ランキングSQLステートメントXML(ProductRanking.xml)
 ･･･････････････････････････････････････････････････････････････････････････････････････････････････････
  Copyright   : Copyright W2 Co.,Ltd. 2010 All Rights Reserved.
=========================================================================================================
-->
<ProductRanking>

  <!-- 重複チェック（商品ランキング情報登録時） -->
  <CheckDuplicationInsertRankingId>
    <Statement>
      <![CDATA[
        SELECT  COUNT(ranking_id) AS ranking_count
          FROM  w2_ProductRanking
         WHERE  w2_ProductRanking.shop_id = @shop_id
           AND  w2_ProductRanking.ranking_id = @ranking_id
      ]]>
    </Statement>
    <Parameter>
      <Input Name="shop_id" Type="nvarchar" Size="10" />
      <Input Name="ranking_id" Type="nvarchar" Size="10" />
    </Parameter>
  </CheckDuplicationInsertRankingId>

  <!-- 重複チェック（商品ランキング情報更新時） -->
  <CheckDuplicationUpdateRankingId>
    <Statement>
      <![CDATA[
        SELECT  COUNT(ranking_id) AS ranking_count
          FROM  w2_ProductRanking
         WHERE  w2_ProductRanking.shop_id = @shop_id
           AND  w2_ProductRanking.ranking_id = @ranking_id
           AND  w2_ProductRanking.ranking_id != @ranking_id_old
      ]]>
    </Statement>
    <Parameter>
      <Input Name="shop_id" Type="nvarchar" Size="10" />
      <Input Name="ranking_id" Type="nvarchar" Size="10" />
      <Input Name="ranking_id_old" Type="nvarchar" Size="10" />
    </Parameter>
  </CheckDuplicationUpdateRankingId>

</ProductRanking>