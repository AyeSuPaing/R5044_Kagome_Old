<?xml version="1.0" encoding="utf-8" ?>
<!--
=========================================================================================================
  Module      : メッセージメール添付系SQLステートメントXML(CsMessageMailAttachment.xml)
 ･･･････････････････････････････････････････････････････････････････････････････････････････････････････
  Copyright   : Copyright w2solution Co.,Ltd. 2013 All Rights Reserved.
=========================================================================================================
-->
<CsMessageMailAttachment>

  <!-- 登録用ファイルNO取得 -->
  <GetRegisterFileNo>
    <Statement>
      <![CDATA[
        SELECT  ISNULL(MAX(file_no),0) + 1 AS file_no
          FROM  w2_CsMessageMailAttachment
         WHERE  dept_id = @dept_id
           AND  mail_id = @mail_id
      ]]>
    </Statement>
    <Parameter>
      <Input Name="dept_id" Type="nvarchar" Size="30" />
      <Input Name="mail_id" Type="nvarchar" Size="30" />
    </Parameter>
  </GetRegisterFileNo>

  <!-- 登録 -->
  <Register>
    <Statement>
      <![CDATA[
        INSERT w2_CsMessageMailAttachment
            (
               dept_id,
               mail_id,
               file_no,
               file_name,
               file_data
            )
            VALUES
            (
              @dept_id,
              @mail_id,
              @file_no,
              @file_name,
              @file_data
            )
      ]]>
    </Statement>
    <Parameter>
      <Input Name="dept_id" Type="nvarchar" Size="30" />
      <Input Name="mail_id" Type="nvarchar" Size="30" />
      <Input Name="file_no" Type="int" />
      <Input Name="file_name" Type="nvarchar" Size="256" />
      <Input Name="file_data" Type="varbinary" Size="max" />
    </Parameter>
  </Register>

</CsMessageMailAttachment>
