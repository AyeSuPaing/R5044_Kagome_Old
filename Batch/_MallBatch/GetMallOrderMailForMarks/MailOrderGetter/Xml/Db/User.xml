<?xml version="1.0" encoding="utf-8" ?>
<!--
=========================================================================================================
  Module      : ユーザ系SQLステートメントXML(User.xml)
 ･･･････････････････････････････････････････････････････････････････････････････････････････････････････
  Copyright   : Copyright w2solution Co.,Ltd. 2009 All Rights Reserved.
=========================================================================================================
-->
<User>

  <!-- ユーザID取得（モールID、メールアドレスから）  -->
  <GetUserIdFromMailAddr>
    <Statement>
      <![CDATA[
        SELECT  user_id
          FROM  w2_User
         WHERE  mall_id = @mall_id
           AND  (del_flg = '0' AND integrated_flg = '0')
           AND  (
                  mail_addr = @mail_addr
                  OR
                  mail_addr2 = @mail_addr
                )
		  ]]>
    </Statement>
    <Parameter>
      <Input Name="mall_id" Type="nvarchar" Size="30" />
      <Input Name="mail_addr" Type="nvarchar" Size="256" />
    </Parameter>
  </GetUserIdFromMailAddr>

  <!-- ユーザ登録 -->
  <InsertUser>
    <Statement>
      <![CDATA[
        INSERT  w2_User
                (
                  user_id,
                  user_kbn,
                  mall_id,
                  name,
                  name1,
                  name2,
                  name_kana,
                  name_kana1,
                  name_kana2,
                  mail_addr,
                  mail_addr2,
                  zip,
                  zip1,
                  zip2,
                  addr,
                  addr1,
                  addr2,
                  addr3,
                  addr4,
                  tel1,
                  tel1_1,
                  tel1_2,
                  tel1_3,
                  sex,
                  birth,
                  birth_year,
                  birth_month,
                  birth_day,
                  login_id,
                  password,
                  mail_flg,
                  date_created,
                  date_changed,
                  last_changed
                )
        VALUES  (
                  @user_id,
                  @user_kbn,
                  @mall_id,
                  @name,
                  @name1,
                  @name2,
                  @name_kana,
                  @name_kana1,
                  @name_kana2,
                  @mail_addr,
                  @mail_addr2,
                  @zip,
                  @zip1,
                  @zip2,
                  @addr,
                  @addr1,
                  @addr2,
                  @addr3,
                  @addr4,
                  @tel1,
                  @tel1_1,
                  @tel1_2,
                  @tel1_3,
                  @sex,
                  @birth,
                  @birth_year,
                  @birth_month,
                  @birth_day,
                  @login_id,
                  @password,
                  @mail_flg,
                  getdate(),
                  getdate(),
                  @last_changed
                )
		  ]]>
    </Statement>
    <Parameter>
      <Input Name="user_id" Type="nvarchar" Size="30" />
      <Input Name="user_kbn" Type="nvarchar" Size="10" />
      <Input Name="mall_id" Type="nvarchar" Size="30" />
      <Input Name="name" Type="nvarchar" Size="40" />
      <Input Name="name1" Type="nvarchar" Size="20" />
      <Input Name="name2" Type="nvarchar" Size="20" />
      <Input Name="name_kana" Type="nvarchar" Size="60" />
      <Input Name="name_kana1" Type="nvarchar" Size="30" />
      <Input Name="name_kana2" Type="nvarchar" Size="30" />
      <Input Name="mail_addr" Type="nvarchar" Size="256" />
      <Input Name="mail_addr2" Type="nvarchar" Size="256" />
      <Input Name="zip" Type="nvarchar" Size="8" />
      <Input Name="zip1" Type="nvarchar" Size="3" />
      <Input Name="zip2" Type="nvarchar" Size="4" />
      <Input Name="addr" Type="nvarchar" Size="200" />
      <Input Name="addr1" Type="nvarchar" Size="50" />
      <Input Name="addr2" Type="nvarchar" Size="50" />
      <Input Name="addr3" Type="nvarchar" Size="50" />
      <Input Name="addr4" Type="nvarchar" Size="50" />
      <Input Name="tel1" Type="nvarchar" Size="16" />
      <Input Name="tel1_1" Type="nvarchar" Size="6" />
      <Input Name="tel1_2" Type="nvarchar" Size="4" />
      <Input Name="tel1_3" Type="nvarchar" Size="4" />
      <Input Name="sex" Type="nvarchar" Size="10" />
      <Input Name="birth" Type="datetime" />
      <Input Name="birth_year" Type="nvarchar" Size="4" />
      <Input Name="birth_month" Type="nvarchar" Size="2" />
      <Input Name="birth_day" Type="nvarchar" Size="2" />
      <Input Name="login_id" Type="nvarchar" Size="256" />
      <Input Name="password" Type="nvarchar" Size="100" />
      <Input Name="mail_flg" Type="nvarchar" Size="10" />
      <Input Name="last_changed" Type="nvarchar" Size="20" />
    </Parameter>
  </InsertUser>

  <!-- ユーザ更新 -->
  <UpdateUser>
    <Statement>
      <![CDATA[
        UPDATE  w2_User
           SET  w2_User.mall_id = @mall_id,
                w2_User.name = @name,
                w2_User.name1 = @name1,
                w2_User.name2 = @name2,
                w2_User.name_kana = @name_kana,
                w2_User.name_kana1 = @name_kana1,
                w2_User.name_kana2 = @name_kana2,
                w2_User.zip = @zip,
                w2_User.addr = @addr,
                w2_User.addr1 = @addr1,
                w2_User.addr2 = @addr2,
                w2_User.addr3 = @addr3,
                w2_User.addr4 = @addr4,
                w2_User.tel1 = @tel1,
                w2_User.date_changed = getdate(),
                w2_User.last_changed = @last_changed
         WHERE  w2_User.user_id = @user_id
		  ]]>
    </Statement>
    <Parameter>
      <Input Name="user_id" Type="nvarchar" Size="30" />
      <Input Name="user_kbn" Type="nvarchar" Size="10" />
      <Input Name="mall_id" Type="nvarchar" Size="30" />
      <Input Name="name" Type="nvarchar" Size="40" />
      <Input Name="name1" Type="nvarchar" Size="20" />
      <Input Name="name2" Type="nvarchar" Size="20" />
      <Input Name="name_kana" Type="nvarchar" Size="60" />
      <Input Name="name_kana1" Type="nvarchar" Size="30" />
      <Input Name="name_kana2" Type="nvarchar" Size="30" />
      <Input Name="zip" Type="nvarchar" Size="8" />
      <Input Name="addr" Type="nvarchar" Size="200" />
      <Input Name="addr1" Type="nvarchar" Size="50" />
      <Input Name="addr2" Type="nvarchar" Size="50" />
      <Input Name="addr3" Type="nvarchar" Size="50" />
      <Input Name="addr4" Type="nvarchar" Size="50" />
      <Input Name="tel1" Type="nvarchar" Size="16" />
      <Input Name="last_changed" Type="nvarchar" Size="20" />
    </Parameter>
  </UpdateUser>

</User>